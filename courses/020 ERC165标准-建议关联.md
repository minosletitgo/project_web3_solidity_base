# 🔥 最常见必须通过 supportsInterface 声明的标准（按类别）

---

# 🟦 A. 核心接口类（基础机制）

这些是所有可检测接口的基础功能：

| 标准                 | interfaceId              | 说明                                |
| ------------------ | ------------------------ | --------------------------------- |
| **ERC-165**        | `0x01ffc9a7`             | 所有可检测接口的基础；必须实现 supportsInterface |
| **ERC-1820**       | 用注册表替代 supportsInterface | 不直接使用 ERC-165，不过概念类似              |
| **ERC-165Storage** | 与 ERC-165 兼容             | 用 storage 管理 interfaceId          |

---

# 🟩 B. ERC-721 相关（NFT 系列）

这些是 **NFT 常用扩展接口**，都需要 supportsInterface。

| 标准                                         | interfaceId  | 用途                           |
| ------------------------------------------ | ------------ | ---------------------------- |
| **ERC-721 (IERC721)**                      | `0x80ac58cd` | NFT 主接口                      |
| **ERC-721 Metadata (IERC721Metadata)**     | `0x5b5e139f` | name / symbol / tokenURI     |
| **ERC-721 Enumerable (IERC721Enumerable)** | `0x780e9d63` | totalSupply、tokenByIndex ... |
| **ERC-4906**                               | `0x49064906` | MetadataUpdate 事件（你刚问的）      |
| **ERC-4494（Permit for ERC721）**            | `0x5604e225` | NFT Permit (EIP-2612 版本)     |
| **ERC-5192（Soulbound 启用/锁定）**              | `0xb45a3c0e` | SBT locked/unlocked          |

---

# 🟨 C. ERC-1155 相关（多代币标准）

ERC-1155 也使用 ERC-165。

| 标准                      | interfaceId  | 用途                |
| ----------------------- | ------------ | ----------------- |
| **ERC-1155**            | `0xd9b67a26` | 主接口               |
| **ERC-1155MetadataURI** | `0x0e89341c` | metadata URI      |
| **ERC-1155Receiver**    | `0x4e2312e0` | onERC1155Received |

---

# 🟧 D. ERC-20 的扩展（注意：ERC-20 本体不基于 ERC-165）

ERC-20 原本不支持 ERC-165，但**一些扩展标准显式加入 ERC-165 支持**：

| 标准                                   | interfaceId      | 说明 |
| ------------------------------------ | ---------------- | -- |
| **ERC-20 Snapshot (ERC-20Snapshot)** | 一些库实现了 ERC-165   | 可选 |
| **ERC-20 Permit (ERC-2612)**         | 通常不通过 165，但可选实现  | 可选 |
| **ERC-20FlashMint**                  | 可选实现 interfaceId | 可选 |

> 重点：ERC-20 不是 ERC-165 接口标准，但一些扩展会自定义 interfaceId 来启用 supportsInterface。

---

# 🟥 E. 合约能力类接口

这类标准定义“合约提供的能力”，因此需要使用 supportsInterface 注册。

| 标准           | interfaceId           | 用途                       |
| ------------ | --------------------- | ------------------------ |
| **ERC-1271** | `0x1626ba7e`          | 合约签名验证（isValidSignature） |
| **ERC-2981** | `0x2a55205a`          | NFT Royalty 版税           |
| **ERC-173**  | 没有固定 id（但常见实现定义了）     | Ownable 标准               |
| **ERC-777**  | 用 ERC-1820，不用 ERC-165 | 回调触发                     |

---

# 🟫 F. 钱包 / 安全相关

有些安全接口也使用 ERC-165。

| 标准           | interfaceId   | 用途                       |
| ------------ | ------------- | ------------------------ |
| **ERC-6372** | `0xc401e3d7`  | Clock 模块（governance 中使用） |
| **ERC-5267** | 有 interfaceId | EIP-712 domain separator |
| **EIP-6900** | 模块化账户系统       | （一些子接口通过 ERC-165 曝光）     |

---

# 🟪 G. 各类“模块化扩展接口”

这些小标准也使用 ERC-165：

| 标准       | 用途                       |
| -------- | ------------------------ |
| ERC-4804 | Web3 URL                 |
| ERC-7546 | Authentication Interface |
| ERC-6220 | Composable NFTs          |
| ERC-7579 | Modular Account System   |

---

# 🎯 最终总结（最关键的规则）

### 🧠 规则 1：

只要标准 **定义了一个 interface（interface IERCxxxx）**，并且列出了 **interfaceId**，
那就一定需要用 **supportsInterface** 来声明支持它。

### 🧠 规则 2：

以太坊上的接口兼容性检测机制“几乎都依赖 ERC-165”。

### 🧠 规则 3：

**最常见、你真正会经常遇到的只有这些：**

* ERC-165（基础）
* ERC-721 / Metadata / Enumerable
* ERC-1155 / Metadata / Receiver
* ERC-2981（NFT Royalty）
* ERC-4906（元数据更新事件）
* ERC-4494（ERC-721 Permit）
* ERC-1271（智能合约签名）
* ERC-5192（SBT）

---

