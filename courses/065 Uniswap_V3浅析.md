#### 概述
- 与前一版本相比，```UniswapV3```引入了一些重要的新特性和改进，主要包括集中流动性(```Concentrated Liquidity```) 和主动市场管理，让流动性提供更加灵活和高效。
- 集中流动性极大地提高了资金的利用效率，在这些区间内，```LPs```的资本效率比```V2```提高了```4000倍```，意味着```LPs```可以用更少的资本获得与```V2```相同的收益。

#### 特性 - 集中流动性
- ```UniswapV2```中，流动性提供者(```LP```)必须在整个价格范围内(0 到 ∞)提供流动性。大多数资金实际上没有被有效利用，因为交易往往集中在特定的价格范围内。
- ```UniswapV3```中，允许```LPs```在"特定的价格区间"内提供流动性，这称为“集中流动性”，提高了资金效率。这个功能可以让```LPs```将他们的资金集中在市场最活跃的价格区间，提升了收益率。
- 例如，一个```LP```可以选择只在```1000到2000美元之间```的```ETH/USD```价格范围提供流动性。如果```ETH```价格超出这个范围，他们的流动性就不会被用于交易，这有助于降低"无常损失"(```Impermanent Loss```)。

#### 特性 - ```LPToken```改为了不可互换的```NFT(ERC721)```
- ```UniswapV2```中，```LP```头寸(```position```)通过```ERC20```代币表示，每个流动性池都使用相同的```LP```代币。
- ```UniswapV3```中，由于```LPs```可以设置不同的价格范围，流动性头寸是独特的，因此使用不可替代```NFT```来表示每个```LP```的头寸。
- 每个```NFT```都包含了流动性提供者的自定义价格区间和资金量等信息。

#### 特性 - 多级费用结构
- ```UniswapV2```中，固定费率为```0.3%```
- ```UniswapV3```中引入了多种不同的费用层级 (**0.05%、0.3%、1%**)，供```LPs```选择，以适应不同的市场条件和风险偏好。
- 交易对的波动性越大，```LPs```通常会选择更高的费用层，以补偿更大的"无常损失"风险。(如，稳定币对，价格波动小，选择低费用层的概率大)
- 手续费归属：```V2/V3``` 均 ```100%``` 给 ```LP```，平台不抽成。

#### 特性 - 自动路由
- ```UniswapV3```中，的交易功能会自动寻找最佳的交易路径(通过前端或聚合器, 如```1inch```)，通过不同的交易对来最大化交易效率。(```V2```不具备该功能)
- 例如，当你想要在 ```ETH 和 USDC``` 之间进行交易时，平台可能会通过多个中间交易对来找到最具成本效益的路径，减少滑点并节省交易成本。

#### 特性 - 价格预言机的升级
- ```UniswapV2```中，预言机的逻辑是，记录"价格"的"累加值"，使用时再除以时间间隔，这是一种"算术平均"。
- ```UniswapV3```中，预言机的逻辑是，记录"价格的幂"(```log(price, 1.0001)```)的"累加值"，使用时再除以时间间隔，这是一种"几何平均"，受短期波动影响更小。

#### 代码架构（与```V2```变化不大）
- ```v3-core```：核心仓库
  - ```UniswapV3Factory.sol```：负责创建和管理流动性池
  - ```UniswapV3Pool.sol```：每个流动性池的核心合约，管理流动性、手续费和交易逻辑。
  - ```Tick.sol``` 和 ```TickBitmap.sol```：用于管理价格区间和流动性分布。
  - ```Oracle.sol```：提供时间加权平均价格 (```TWAP```) 预言机功能。
- ```v3-periphery```：外围仓库。
  - ```SwapRouter.sol```：兑换路由（只提供，交易操作入口）。
  - ```NonfungiblePositionManager.sol```：头寸管理（只提供，流动性操作入口）。
  
